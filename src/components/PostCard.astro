---
interface Props {
  slug: string;
  title: string;
  date: Date;
  description?: string;
  tags: string[];
  cover?: string;
  readingTime: number;
}

const { slug, title, date, description, tags, cover, readingTime } = Astro.props;

const coverMatch = cover?.match(/^(.+)-(\d+)\.(\w+)$/);
const thumbSrc = coverMatch ? `${coverMatch[1]}-480.${coverMatch[3]}` : null;
---

<a
  href={`/${slug}`}
  class="group flex flex-col overflow-hidden rounded-lg border border-gray-200 transition-colors hover:border-gray-400 dark:border-gray-800 dark:hover:border-gray-600"
>
  {
    thumbSrc && (
      <div class="aspect-[2/1] overflow-hidden bg-gray-100 dark:bg-gray-900">
        <img
          src={thumbSrc}
          alt={title}
          width="480"
          height="240"
          loading="lazy"
          decoding="async"
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
        />
      </div>
    )
  }
  <div class="flex flex-1 flex-col p-5">
    <time datetime={date.toISOString()} class="mb-2 text-xs text-gray-500 dark:text-gray-500">
      {
        date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
        })
      }
    </time>
    <h2 class="mb-2 text-base font-medium text-gray-900 dark:text-gray-100">
      {title}
    </h2>
    {
      description && (
        <p class="mb-3 line-clamp-2 text-sm text-gray-600 dark:text-gray-400">{description}</p>
      )
    }
    <div class="mt-auto flex items-center gap-2">
      <span class="text-xs text-gray-500 dark:text-gray-500">{readingTime} min read</span>
      {
        tags.length > 0 && (
          <div class="flex gap-1.5">
            {tags.slice(0, 2).map((tag: string) => (
              <span class="rounded bg-gray-100 px-1.5 py-0.5 text-xs text-gray-600 dark:bg-gray-900 dark:text-gray-400">
                {tag}
              </span>
            ))}
          </div>
        )
      }
    </div>
  </div>
</a>
